function dateFormatter(value){var format=moment(value).format("DD MMMM, YYYY");return"<div>"+format+"<\/div>"}function editCloseFormatter(){return'<button type="button" class="edit btn btn-sm btn-warning" title="Edit"><i class="now-ui-icons ui-2_settings-90"><\/i><\/button>'}function deleteCloseFormatter(){return'<button type="button" class="remove btn btn-sm btn-danger" title="Delete"><i class="now-ui-icons ui-1_simple-remove"><\/i> <\/button>'}function initTillMapValidation(){jQuery.validator.setDefaults({onfocusout:!1,onkeyup:!1,onclick:!1,normalizer:function(value){return $.trim(value)},errorPlacement:function(error){$.notify({icon:"now-ui-icons travel_info",message:error.text()},{type:"danger",placement:{from:"top",align:"right"}})}});$("#frmAcctClosed").validate({messages:{name:{required:"Ledger Account is required"}}})}function AddClosedAccounts(){var form=$("#frmAcctClosed");if(form.valid()){var payableamt=form.find("[name=payableamount]").val(),accountno=form.find("[name=accountnumber]").val(),availablebal=form.find("[name=availablebalance]").val(),freezeAmt=form.find("[name=freezeAmount]").val(),smsaccude=form.find("[name=smsAccude]").val(),cotaccude=form.find("[name=cotAccude]").val(),interesetaccude=form.find("[name=interesetAccude]").val(),charge=form.find("[name=charges]").val(),ledgeracctid=form.find("#chartofaccountid").val(),commnt=form.find("[name=comment]").val();swal({title:"Are you sure?",text:"Close Account data will be submitted",type:"question",showCancelButton:!0,confirmButtonColor:"#34D027",confirmButtonText:"Yes, continue",cancelButtonText:"No, stop!",cancelButtonColor:"#ff9800",showLoaderOnConfirm:!0,preConfirm:function(){return new Promise(function(resolve){setTimeout(function(){resolve()},1e3)})}}).then(function(isConfirm){isConfirm&&$.ajax(url_path+"/AddClosedAccounts",{method:"POST",dataType:"json",data:{payableamount:payableamt,accountnumber:accountno,availablebalance:availablebal,freezeAmount:freezeAmt,smsAccude:smsaccude,CotAccude:cotaccude,InteresetAccude:interesetaccude,Charges:charge,Ledgeraccountid:ledgeracctid,Comment:commnt}}).then(function(response){response==!0?swal({title:"Close Account",text:"successfully saved Close Account!",type:"success"}).then(function(){window.location.reload()}):swal({title:"Close Account",type:"error",text:"This Account is either Closed or Pending For Closure!"}).then(function(){window.location.reload()})})},function(){return})}}var url_path=window.location.pathname,define;url_path.charAt(url_path.length-1)=="/"&&(url_path=url_path.slice(0,url_path.length-1));$(document).ready(function(){initTillMapValidation()});$.ajax(url_path+"/GetChartOfAccountLocally").then(function(response){$("#chartofaccountid").select2({placeholder:"Select Ledger to credit",data:response,width:"100%",dropdownParent:$("#AddNewClosed.modal")})});window.CloseEvents={"click .edit":function(e,value,row){var form=$("#frmAcctClosed"),acctNumber;if(form.trigger("reset"),row.state=!0){form.find("[name=id]").val(row.id);form.find("[name=accountnumber]").val(row.accountnumber);form.find("[name=accountname]").val(row.accountname);acctNumber=document.getElementById("accountnumber").value;let chargesAmt;$.ajax({url:url_path+"/listPendingCharges",method:"GET",data:{accountNumber:acctNumber},contentType:"application/json",success:function(){},error:function(){swal({title:"Closed Account",text:"encountered error. unable to reach controller",type:"error"})}}).then(function(result){$("#interesetAccude").val(result.results[0].interestCalculation);$("#cotAccude").val(result.results[0].cotCalculation);$("#smsAccude").val(result.results[0].smsCalculation);$("#freezeAmount").val(result.results[0].freezePlaced);$("#availablebalance").val(result.results[0].endbal);$("#payableamount").val(result.results[0].payable);$("#chargesAccrue").val(result.results[0].chargesCalculation);chargesAmt=result.results[0].chargesCalculation;$("#chaneTitle").text("Update");form.find("#btnPostClosed").show();$("#AddNewClosed").modal("show")})}}};define={CloseAcctTableFormatter:function(index,row,el){var container=$("<div class='row mx-0'><\/div>");container.append($("<div class='col-xs-12 col-md-6 mb-3 mt-2'><b>Casaaccount Id :<\/b> "+row.casaaccountid+"<\/div>"));container.append($("<div class='col-xs-12 col-md-6 mb-3 mt-2'><b>Product Id :<\/b> "+row.productid+"<\/div>"));container.append($("<div class='col-xs-12 col-md-6 mb-3 mt-2'><b>Status:<\/b> "+row.accountstatusid+"<\/div>"));container.append($("<div class='col-xs-12 col-md-6 mb-2'><b>Date Created :<\/b> "+moment(row.datecreated).format("MMMM DD, YYYY")+"<\/div>"));el.append(container)}};