function initSelectTwoConfig(){$.fn.select2.defaults.set("theme","bootstrap4");$.fn.select2.defaults.set("dropdownParent",$(".modal").first());$.fn.select2.defaults.set("width","100%");$.fn.select2.defaults.set("allowClear",!0);$.ajax("../Profile/LoadBanks").then(function(response){$("#ddlUBank").select2({placeholder:"Select bank",dropdownParent:$("#refereeUpdateModal.modal"),data:response})})}function initFormValidations(){jQuery.validator.setDefaults({onfocusout:!1,onkeyup:!1,onclick:!1,normalizer:function(value){return $.trim(value)},errorPlacement:function(error){$.notify({icon:"now-ui-icons travel_info",message:error.text()},{type:"danger",placement:{from:"top",align:"right"}})}});$("#frmrefereeUpdate").each(function(){$(this).validate({messages:{fullname:{required:"Referee's full name is required"},address:{required:"Referee's address is required"},phone:{required:"Referee's phone number is required"},relationship:{required:"Referee's relationship is required"},accountname:{required:"Referee's account name is required"},accountno:{required:"Referee's account number is required"},bankid:{required:"Referee's bank is required"},bankaddress:{required:"Referee's bank address is required"},"referee-file":{required:"Referee's document is required"}}})})}function initDataTable(){$("#data-table").bootstrapTable("showLoading");$("#data-table").bootstrapTable({search:!0,searchAlign:"right",detailView:!0,detailFormatter:utilities.mandateDetailTableFormatter,url:"../Account/LoadAccounts",showPaginationSwitch:!0,pagination:!0,mobileResponsive:!0,checkOnInit:!0,minWidth:626,toolbar:"#custom-toolbar",showRefresh:!0,showToggle:!0,uniqueId:"casaaccountid",buttonsClass:"danger",columns:[{field:"accountnumber",title:"Account Number",sortable:!0},{field:"accountname",title:"Account Name",sortable:!0},{field:"productName",title:"Product",sortable:!0},{field:"postnostatusid",title:"Status",sortable:!0},{field:null,align:"center",width:"5%",formatter:utilities.dropDownFormatter},]})}function mandateUpdate(self){casaaccountNumber=self;UpdateAccount=$("#data-table").bootstrapTable("getRowByUniqueId",self);utilities.updateWizardHeader("#mandateUpdateModal");$("#mandateImage").empty();$.ajax("../Account/LoadAccountMandateMaintenance/"+self).then(function(response){response?($("#mandateUpdateTable").bootstrapTable("load",response),$("#mandateUpdateTable").bootstrapTable("hideLoading"),$("#frmMandateUpdate").closest("div.row").hide(),$("#mandateUpdateTable").closest("div.row").show(),$("#mandate-toolbar").show(),$("#mandateUpdateTable #title").text("Account Mandate(es)"),$("#mandateUpdateModal").modal("show")):swal({title:"View Mandate",text:"No Mandate Available for Account Yet",type:"error",allowOutsideClick:!1,allowEscapeKey:!1})})}function handleRefereeUpdate(self){casaaccountNumber=self;UpdateAccount=$("#data-table").bootstrapTable("getRowByUniqueId",self);utilities.updateWizardHeaderReferee("#refereeUpdateModal");$("#refereeUpdateModal #status").text(" ");$.ajax("../Account/LoadAccountReferees/"+self).then(function(response){console.log(response);response&&($("#refereeUpdateTable").bootstrapTable("load",response),$("#refereeUpdateTable").bootstrapTable("hideLoading"),$("#frmrefereeUpdate").closest("div.row").hide(),$("#refereeUpdateTable").closest("div.row").show(),$("#referee-toolbar").show(),$("#refereeUpdateTable #title").text("Account Referee(s)"),$("#refereeUpdateModal").modal("show"))})}function productConversionHandler(self){casaaccountNumber=self;casaAccountId=self;UpdateAccount=$("#data-table").bootstrapTable("getRowByUniqueId",self);utilities.updateWizardHeaderProductConversion("#productConversionModal");utilities.updateWizardHeaderProductConversion2("#productConversionModal");$("#formProductUpdate #updateBtn").removeAttr("disabled");$.ajax("../Account/CheckApprovalStatus/"+casaAccountId).then(function(response){approvalstatusBoolean=response;response=="Pending"&&$("#productConversionModal .headerProductConversionDetails3").text("Pending Approval");response=="Disapproved"&&$("#productConversionModal .headerProductConversionDetails3").text("Disapproved");response=="Approved"&&$("#productConversionModal .headerProductConversionDetails3").text(" ");$.ajax("../Account/LoadProducts/").then(function(response){console.log(response);response&&($("#productListTable").bootstrapTable("load",response),$("#productListTable").bootstrapTable("hideLoading"),$("#productListTable").closest("div.row").show(),$("#productConversionModal").modal("show"))})});approvalstatusBoolean=" "}function emailMaintenanceHandler(self){casaaccountNumber=self;updateEmail=$("#data-table").bootstrapTable("getRowByUniqueId",self);$("#frmEmailUpdate").closest("div.row").hide();$("#emailUpdateTable").closest("div.row").show();$("#emailUpdateModal #title").text("Customer E-mail(s)");$("#emailUpdateModal").modal("show")}function feeMaintenanceHandler(self){approvalStatusLogOut=" ";casaAccountId=self;casaRowContent=$("#data-table").bootstrapTable("getRowByUniqueId",self);casaaccountNumber=casaRowContent.accountnumber;productId=casaRowContent.productid;utilities.updateWizardHeaderFeeMaintenance("#accountFeeUpdateModal");$("#formproductMappingFeesUpdate").closest("div.row").hide();$("#productMappingFeesTable").closest("div.row").show();$("#accountFeeUpdateModal #title").text("Customer E-mail(s)");var $table=$("#productMappingFeesTable");$table.bootstrapTable("uncheckAll");productFeeList=[];productFeeListId=[];productFeeListOriginal=[];productFeeListIdOriginal=[];productFeeListIdExtra=[];productFeeListExtra=[];$.ajax({type:"GET",url:url_path+"/../GetFeeName?productName="+casaRowContent.productName+"&casaAccountId="+casaAccountId,success:function(result){console.log(result);$.each(result,function(index,value){productFeeListId.push(value.id);productFeeList.push(value.feeId);productFeeListOriginal.push(value.feeId);productFeeListIdOriginal.push(value.id)});$table.bootstrapTable("checkBy",{field:"pdFeesId",values:productFeeList})}});$.ajax({type:"GET",url:url_path+"/../GetFeeExtraName?productName="+casaRowContent.productName+"&casaAccountId="+casaAccountId,success:function(result){console.log(result);$.each(result,function(index,value){approvalStatusLogOut=value.approvalstatus;console.log(approvalStatusLogOut);productFeeListId.push(value.id);productFeeList.push(value.feeId);productFeeListIdExtra.push(value.id);productFeeListExtra.push(value.feeId)});$table.bootstrapTable("checkBy",{field:"pdFeesId",values:productFeeList})}});setTimeout(function(){approvalStatusLogOut=="New Copy Sent for Approval"?$("#accountFeeUpdateModal .ApprovalDetails").text("New Copy Sent for Approval"):approvalStatusLogOut=="Pending"?$("#accountFeeUpdateModal .ApprovalDetails").text("Pending Approval"):$("#accountFeeUpdateModal .ApprovalDetails").text("")},500);setTimeout(function(){$("#accountFeeUpdateModal").modal("show")},800)}function updateLinkedFees(){var $table,selectionData,newselectionData,counter,detectforapproval;if(approvalStatusLogOut=="New Copy Sent for Approval"||approvalStatusLogOut=="Pending"){swal({title:"Product Fee Approval",text:"Transaction Awaiting Approval",type:"error"});return}$table=$("#productMappingFeesTable");casaaccountNumber=casaRowContent.accountnumber;selectionData=$table.bootstrapTable("getAllSelections");productFeeListNew=[];newselectionData=[];$.each(selectionData,function(index,itemData){productFeeListOriginal.includes(itemData.pdFeesId)||(productFeeListNew.push(itemData.pdFeesId),newselectionData.push(itemData))});counter=0;$.each(productFeeListExtra,function(index,itemData){console.log(itemData);productFeeListExtra.includes(itemData)&&productFeeListNew.includes(itemData)?(console.log("Do Nothing"),console.log(itemData)):!productFeeListExtra.includes(itemData)&&productFeeListNew.includes(itemData)?(console.log("Insert Into Database"),console.log(itemData)):productFeeListExtra.includes(itemData)&&!productFeeListNew.includes(itemData)&&(console.log("Delete from Database"),$.ajax({url:"../Account/DeleteProductFeesList",type:"POST",data:{Id:productFeeListIdExtra[counter],PdFeesId:"",productId:productId,PdFeesName:"",PdRate:""},success:function(){},error:function(){}}),console.log(itemData),console.log(productFeeListIdExtra[counter]));counter++});counter=0;detectforapproval=!1;$.each(newselectionData,function(index,itemData){productFeeListNew.includes(itemData.pdFeesId)&&productFeeListExtra.includes(itemData.pdFeesId)?(console.log("Do Nothing"),console.log(itemData)):productFeeListNew.includes(itemData.pdFeesId)&&!productFeeListExtra.includes(itemData.pdFeesId)?$.ajax({url:"../Account/AddProductFeesList",type:"POST",data:{Id:1,PdFeesId:newselectionData[counter].pdFeesId,casaAccountId:casaAccountId,productId:productId,PdFeesName:newselectionData[counter].pdFeesName,PdRate:newselectionData[counter].pdRate},success:function(){},error:function(){}}):!productFeeListNew.includes(itemData.pdFeesId)&&productFeeListExtra.includes(itemData.pdFeesId);counter++});setTimeout(function(){detectforapproval==!1&&$.ajax({url:"../Account/AddProductFeesListForApprovalOnly",type:"POST",data:{casaAccountId:casaAccountId},success:function(){},error:function(){}})},3e3);swal({title:"Add Fees to Product",text:"CASA Fees Addition/Deletion Completed successfully!",type:"success"}).then(function(){});casaRowContent=$("#data-table").bootstrapTable("getRowByUniqueId",casaAccountId);casaaccountNumber=casaRowContent.accountnumber;$table.bootstrapTable("uncheckAll");productFeeList=[];productFeeListId=[];productFeeListOriginal=[];productFeeListIdOriginal=[];productFeeListIdExtra=[];productFeeListExtra=[];$.ajax({type:"GET",url:"../Account/GetFeeName?productName="+casaRowContent.productName+"&casaAccountId="+casaAccountId,success:function(result){$.each(result,function(index,value){productFeeListId.push(value.id);productFeeList.push(value.feeId);productFeeListOriginal.push(value.feeId);productFeeListIdOriginal.push(value.id)})}});$.ajax({type:"GET",url:"../Account/GetFeeExtraName?productName="+casaRowContent.productName+"&casaAccountId="+casaAccountId,success:function(result){$.each(result,function(index,value){productFeeListId.push(value.id);productFeeList.push(value.feeId);productFeeListIdExtra.push(value.id);productFeeListExtra.push(value.feeId)})}});$("#accountFeeUpdateModal").modal("hide")}var url_path=window.location.pathname,utilities;url_path.charAt(url_path.length-1)=="/"&&(url_path=url_path.slice(0,url_path.length-1));var CustomerType,UpdateCustomer,UpdateAccount,AddressTypes,LGAs=[],Industries=[],tracker=0,mandateRowObject,casaaccountNumber,updateEmail,casaAccountId,casaRowContent,productId,productFeeList=[],productFeeListId=[],productFeeListOriginal=[],productFeeListIdOriginal=[],productFeeListExtra=[],productFeeListIdExtra=[],approvalStatus=[],approvalStatusLogOut,approvalstatusBoolean;$(document).ready(function(){initDataTable();initSelectTwoConfig();initFormValidations();$(".modal").perfectScrollbar()});$("#mandateUpdateTable").on("check.bs.table",function(row,$element){var mandateUpdateForm,bottom_row,html;if($element.approvalstatus=="New Copy Awaiting Approval"||$element.approvalstatus=="Awaiting First Approval"){swal({title:"Update Mandate",text:"Mandate has an existing entry awaiting approval",type:"error",allowOutsideClick:!1,allowEscapeKey:!1}).then(function(){return});return}mandateUpdateForm=$("#frmMandateUpdate");mandateUpdateForm.find("[name=mandateid]").val($element.mandateId);mandateUpdateForm.find("[name=mandatedescription]").val($element.description);mandateUpdateForm.find("[name=mandateType]").text($element.description);mandateUpdateForm.find("[name=fileid]").val($element.fileId);$("#mandateUpdateModal #title").text("Edit Mandate");$("#frmMandateUpdate #saveBtn").hide();$("#frmMandateUpdate #updateBtn").show();$("#frmMandateUpdate #doneBtn").hide();$("#frmMandateUpdate #updateBtn").removeAttr("disabled");bottom_row=$("#mandateImage");html=[];html.push("<p><img src='data:"+$element.mime+";base64,"+$element.byte+" ' alt='Trulli' width='400' height='233'><\/p>");bottom_row.append(html.join(""));$("#mandateUpdateTable").closest("div.row").slideToggle({duration:utilities.animDuration,queue:!1});$("#frmMandateUpdate").closest("div.row").slideToggle({duration:utilities.animDuration,queue:!1})});utilities={animDuration:400,mandateDetailTableFormatter:function(index,row,detail){detail.html("Loading...");var mandates,bvn;bvn=row.bvn;$.when($.ajax("../Account/LoadAccountMandate/"+row.casaaccountid).then(function(response){mandates=response;console.log(mandates)})).then(function(){var top_row=$("<div class='row'><\/div>"),bottom_row=$("<div class='row'><\/div>"),bvn_col=$("<div class='col-sm-12 col-md-6'><\/div>"),phone_col=$("<div class='col-sm-12 col-md-6'><\/div>"),email_col=$("<div class='col-sm-12 col-md-6'><\/div>"),mandates_col;mandates.length==0||mandates==!1?(mandates_col=$("<div class='col-sm-12 col-md-6'><\/div>"),mandates_col.append("<p>No Mandate Record Found.<\/p>"),bottom_row.append(mandates_col)):$.each(mandates,function(index,value){var mandates_col=$("<div class='col-sm-12 col-md-6'><\/div>"),html;mandates_col.append("<p>&nbsp;<\/p>");mandates_col.append("<h6 class='detail-primary d-inline-block mb-3'>"+value.description+"<\/h6>");mandates_col.append("<p>&nbsp;<\/p>");html=[];html.push("<p><img src='data:"+value.mime+";base64,"+value.byte+" ' alt='Mandates Image' width='300' height='233'><\/p>");mandates_col.append(html.join(""));bottom_row.append(mandates_col)});detail.empty();detail.append(top_row,bottom_row)})},showNewAddFrm:function(){$("#frmAddressUpdate").trigger("reset");$("#frmAddressUpdate select").val(null).change();$("#addressUpdateModal #title").text("Add New Address");$("#frmAddressUpdate #saveBtn").show();$("#frmAddressUpdate #updateBtn").hide();$("#addressUpdateTable").closest("div.row").slideToggle({duration:utilities.animDuration,queue:!1});$("#frmAddressUpdate").closest("div.row").slideToggle({duration:utilities.animDuration,queue:!1})},dropDownFormatter:function(value,row){return["<div class='dropdown'>","<button class='btn btn-info btn-icon' ","data-toggle='dropdown' type='button'>","<i class='fas fa-edit'><\/i>","<\/button>","<div class='dropdown-menu dropdown-menu-right'>","<h6 class='dropdown-header'>Maintain<\/h6>","<a class='dropdown-item'"," onclick='mandateUpdate("+row.casaaccountid+")'>","Mandate Maintenance","<\/a>","<a class='dropdown-item'"," onclick='productConversionHandler("+row.casaaccountid+")'>","Product Conversion","<\/a>","<a class='dropdown-item'"," onclick='handleRefereeUpdate("+row.casaaccountid+")'>","Refree Maintenance","<\/a>","<a class='dropdown-item'"," onclick='feeMaintenanceHandler("+row.casaaccountid+")'>","Account Fee Maintenance","<\/a>","<\/div>","<\/div>"].join("")},editMandateBtnFormatter:function(val,row){return mandateRowObject=row,"<button class='btn btn-warning btn-icon' onclick='utilities.populateMandateFrm()'><i class='now-ui-icons ui-2_settings-90'><\/i><\/button>"},populateMandateFrm:function(){var $table=$("#mandateUpdateTable"),mandateUpdateForm;console.log("getSelections: "+JSON.stringify($table.bootstrapTable("getSelections")));mandateUpdateForm=$("#frmMandateUpdate");mandateUpdateForm.find("[name=mandateid]").val(mandateId);mandateUpdateForm.find("[name=mandatedescription]").val(description);mandateUpdateForm.find("[name=fileid]").val(description);mandateUpdateForm.find("[name=mandateType]").text(description);$("#mandateUpdateModal #title").text("Edit Mandate");$("#frmMandateUpdate #saveBtn").hide();$("#frmMandateUpdate #updateBtn").show();$("#mandateUpdateTable").closest("div.row").slideToggle({duration:utilities.animDuration,queue:!1});$("#frmMandateUpdate").closest("div.row").slideToggle({duration:utilities.animDuration,queue:!1})},showMandateTable:function(){$("#mandateUpdateTable").closest("div.row").slideToggle({duration:utilities.animDuration,queue:!1});$("#frmMandateUpdate").closest("div.row").slideToggle({duration:utilities.animDuration,queue:!1});$("#mandateImage").empty();$("#frmMandateUpdate").trigger("reset")},updateWizardHeader:function(container){$(container+" .headerAcctDetails").text("Account Number: "+UpdateAccount.accountnumber)},updateWizardHeaderReferee:function(container){$(container+" .headerrefereeDetails").text("Account Number: "+UpdateAccount.accountnumber)},updateWizardHeaderProductConversion:function(container){$(container+" .headerProductConversionDetails").text("Account Number: "+UpdateAccount.accountnumber)},updateWizardHeaderProductConversion2:function(container){$(container+" .headerProductConversionDetails2").text("Account Product Name: "+UpdateAccount.productName)},updateWizardHeaderFeeMaintenance:function(container){$(container+" .headerAcctFeeDetails").text("CASA Account Number: "+casaaccountNumber)},updateMandate:function(){var form=$("#frmMandateUpdate");form.valid()&&swal({title:"Are you sure?",text:"Mandate data will be updated",type:"question",showCancelButton:!0,confirmButtonColor:"#34D027",confirmButtonText:"Yes, continue",cancelButtonText:"No, stop!",cancelButtonColor:"#ff9800",showLoaderOnConfirm:!0,preConfirm:function(){return new Promise(function(resolve){setTimeout(function(){resolve()},1e3)})}}).then(function(isConfirm){var form_array,form_data,mandateUpdateImage,form_bag;if(isConfirm){form_array=form.serializeArray();form_array=$.map(form_array,function(item){return $.trim(item.value).length!==0?item:null});form_data={};$.each(form_array,function(index,item){form_data[item.name]=item.value});mandateUpdateImage=form.find("input[name=mandate-image]").get(0).files;form_bag=new FormData;form_bag.append("Data",JSON.stringify(form_data));mandateUpdateImage.length&&form_bag.append("Mandate",mandateUpdateImage[0]);var id=form.find("[name=mandatedescription]").val(),fileid=form.find("[name=fileid]").val(),mandateid=form.find("[name=mandateid]").val();$.ajax("../Account/AddMandateUpdate/"+id+"/?fileid="+fileid+"&mandateid="+mandateid,{method:"POST",contentType:!1,processData:!1,data:form_bag}).then(function(response){console.log(response);$("#mandateImage").empty();var bottom_row=$("#mandateImage"),html=[];html.push("<p><img src='data:"+response.mime+";base64,"+response.byte+" ' alt='Mandate Image' width='400' height='233'><\/p>");bottom_row.append(html.join(""));$("#mandateUpdateTable").bootstrapTable("refresh",{url:"../Account/LoadAccountMandateMaintenance/"+casaaccountNumber});$("#frmMandateUpdate #doneBtn").show();$("#frmMandateUpdate #updateBtn").prop("disabled",!0);swal({title:"Update Mandate",text:"Account Mandate succesfully sent for Approval",type:"success",allowOutsideClick:!1,allowEscapeKey:!1}).then(function(){})},function(){swal({title:"Update Mandate",text:"An error was encountered while adding Mandate",type:"error",allowOutsideClick:!1,allowEscapeKey:!1}).then(function(){})})}},function(){return})},showNewRefreeFrm:function(){$("#frmrefereeUpdate").trigger("reset");$("#frmrefereeUpdate select").val(null).change();$("#refereeUpdateModal #status").text("Add New Referee");$("#frmrefereeUpdate #saveBtn").show();$("#frmrefereeUpdate #updateBtn").hide();$("#refereeUpdateTable").closest("div.row").slideToggle({duration:utilities.animDuration,queue:!1});$("#frmrefereeUpdate").closest("div.row").slideToggle({duration:utilities.animDuration,queue:!1})},editRefereeBtnFormatter:function(val,row){return["<button class='btn btn-warning btn-icon' ","onclick='utilities.populateRefereeFrm("+row.refereeid+")'>","<i class='now-ui-icons ui-2_settings-90'>","<\/i><\/button>"].join("")},populateRefereeFrm:function(refereeid){var row,refereeForm;row=$("#refereeUpdateTable").bootstrapTable("getRowByUniqueId",refereeid);row.approvalstatus=="Pending"||row.approvalstatus=="New Copy Sent for Approval"?swal({title:"Update Referee",text:"Referee has an existing entry awaiting approval",type:"error",allowOutsideClick:!1,allowEscapeKey:!1}).then(function(){return}):(refereeForm=$("#frmrefereeUpdate"),refereeForm.find("[name=casaaccountid]").val(row.casaaccountid),refereeForm.find("[name=refereeid]").val(row.refereeid),refereeForm.find("[name=fullname]").val(row.fullname),refereeForm.find("[name=address]").val(row.address),refereeForm.find("[name=phone]").val(row.phone),refereeForm.find("[name=city]").val(row.accountno),refereeForm.find("[name=relationship]").val(row.relationship),refereeForm.find("[name=accountname]").val(row.accountname),refereeForm.find("[name=accountno]").val(row.accountno),refereeForm.find("[name=bankid]").val(row.bankid).change(),refereeForm.find("[name=bankaddress]").val(row.bankaddress),refereeForm.find("[name=datecreated]").val(row.datecreated),$("#refereeUpdateModal #status").text("Edit Referee"),$("#frmrefereeUpdate #saveBtn").hide(),$("#frmrefereeUpdate #updateBtn").show(),$("#refereeUpdateTable").closest("div.row").slideToggle({duration:utilities.animDuration,queue:!1}),$("#frmrefereeUpdate").closest("div.row").slideToggle({duration:utilities.animDuration,queue:!1}))},showRefereeTable:function(){$("#refereeUpdateTable").closest("div.row").slideToggle({duration:utilities.animDuration,queue:!1});$("#frmrefereeUpdate").closest("div.row").slideToggle({duration:utilities.animDuration,queue:!1});$("#refereeUpdateModal #status").text(" ");$("#frmrefereeUpdate").trigger("reset")},addNewReferee:function(){var form=$("#frmrefereeUpdate");form.valid()&&swal({title:"Are you sure?",text:"Referee data will be submitted",type:"question",showCancelButton:!0,confirmButtonColor:"#34D027",confirmButtonText:"Yes, continue",cancelButtonText:"No, stop!",cancelButtonColor:"#ff9800",showLoaderOnConfirm:!0,preConfirm:function(){return new Promise(function(resolve){setTimeout(function(){resolve()},1e3)})}}).then(function(isConfirm){var form_array,form_data,document,form_bag;isConfirm&&(form_array=form.serializeArray(),form_array=$.map(form_array,function(item){return $.trim(item.value).length!==0?item:null}),form_data={},$.each(form_array,function(index,item){form_data[item.name]=item.value}),document=form.find("input[name=referee-file]").get(0).files[0],form_bag=new FormData,form_bag.append("Document",document),form_bag.append("Data",JSON.stringify(form_data)),$.ajax("../Account/AddAccountReferee/"+UpdateAccount.casaaccountid+"/?sendall=true",{method:"POST",contentType:!1,processData:!1,data:form_bag}).then(function(response){$("#refereeUpdateTable").bootstrapTable("load",response);swal({title:"Add Referee",text:"Account referee succesfully added",type:"success",allowOutsideClick:!1,allowEscapeKey:!1}).then(function(){utilities.showRefereeUpdateTable();form.trigger("reset");form.find("select").val(null).trigger("change")})},function(){swal({title:"Add Referee",text:"An error was encountered while adding new referee",type:"error",allowOutsideClick:!1,allowEscapeKey:!1}).then(function(){})}))},function(){return})},updateRefereeInfo:function(){var form=$("#frmrefereeUpdate");form.valid()&&swal({title:"Are you sure?",text:"Referee data will be Updated",type:"question",showCancelButton:!0,confirmButtonColor:"#34D027",confirmButtonText:"Yes, continue",cancelButtonText:"No, stop!",cancelButtonColor:"#ff9800",showLoaderOnConfirm:!0,preConfirm:function(){return new Promise(function(resolve){setTimeout(function(){resolve()},1e3)})}}).then(function(isConfirm){var form_array,form_data,document,form_bag;isConfirm&&(form_array=form.serializeArray(),form_array=$.map(form_array,function(item){return $.trim(item.value).length!==0?item:null}),form_data={},$.each(form_array,function(index,item){form_data[item.name]=item.value}),document=form.find("input[name=referee-file]").get(0).files[0],form_bag=new FormData,form_bag.append("Document",document),form_bag.append("Data",JSON.stringify(form_data)),$.ajax("../Account/UpdateAccountReferee/"+UpdateAccount.casaaccountid+"/?sendall=true",{method:"POST",contentType:!1,processData:!1,data:form_bag}).then(function(response){$("#refereeUpdateTable").bootstrapTable("load",response);swal({title:"Update Referee",text:"Account referee updated sucessfully",type:"success",allowOutsideClick:!1,allowEscapeKey:!1}).then(function(){utilities.showRefereeUpdateTable();form.trigger("reset");form.find("select").val(null).trigger("change")})},function(){swal({title:"Add Referee",text:"An error was encountered while adding new referee",type:"error",allowOutsideClick:!1,allowEscapeKey:!1}).then(function(){$(button).removeAttr("disabled")})}))},function(){return})},showRefereeUpdateTable:function(){$("#refereeUpdateTable").closest("div.row").slideToggle({duration:utilities.animDuration,queue:!1});$("#frmrefereeUpdate").closest("div.row").slideToggle({duration:utilities.animDuration,queue:!1});$("#frmrefereeUpdate").closest(".card-wizard").find(".card-footer").show()},editEmailBtnFormatter:function(val,row){return["<button class='btn btn-warning btn-icon' ","onclick='utilities.populateEmailForm("+row.emailcontactid+")'>","<i class='now-ui-icons ui-2_settings-90'>","<\/i><\/button>"].join("")},populateEmailForm:function(emailid){var row=$("#emailUpdateTable").bootstrapTable("getRowByUniqueId",emailid),emailForm=$("#frmEmailUpdate");emailForm.find("[name=emailcontactid]").val(row.emailcontactid);emailForm.find("[name=customerid]").val(row.customerid);emailForm.find("[name=email]").val(row.email);$("#emailUpdateModal #title").text("Edit E-mail");$("#frmEmailUpdate #saveBtn").hide();$("#frmEmailUpdate #updateBtn").show();$("#emailUpdateTable").closest("div.row").slideToggle({duration:utilities.animDuration,queue:!1});$("#frmEmailUpdate").closest("div.row").slideToggle({duration:utilities.animDuration,queue:!1})},showNewEmailFrm:function(){$("#frmEmailUpdate").trigger("reset");$("#emailUpdateModal #title").text("Add New E-mail");$("#frmEmailUpdate #saveBtn").show();$("#frmEmailUpdate #updateBtn").hide();$("#emailUpdateTable").closest("div.row").slideToggle({duration:utilities.animDuration,queue:!1});$("#frmEmailUpdate").closest("div.row").slideToggle({duration:utilities.animDuration,queue:!1})},updateLinkedFees2:function(){var $table,selectionData,newselectionData,counter;$table=$("#productMappingFeesTable");casaaccountNumber=casaRowContent.accountnumber;selectionData=$table.bootstrapTable("getAllSelections");console.log(productFeeListExtra);productFeeListNew=[];newselectionData=[];$.each(selectionData,function(index,itemData){productFeeListOriginal.includes(itemData.pdFeesId)||(productFeeListNew.push(itemData.pdFeesId),newselectionData.push(itemData))});console.log(newselectionData);counter=0;$.each(productFeeListExtra,function(index,itemData){console.log(itemData);productFeeListExtra.includes(itemData)&&productFeeListNew.includes(itemData)?(console.log("Do Nothing"),console.log(itemData)):!productFeeListExtra.includes(itemData)&&productFeeListNew.includes(itemData)?(console.log("Insert Into Database"),console.log(itemData)):productFeeListExtra.includes(itemData)&&!productFeeListNew.includes(itemData)&&(console.log("Delete from Database"),$.ajax({url:"../Account/DeleteProductFeesList",type:"POST",data:{Id:productFeeListIdExtra[counter],PdFeesId:"",productId:productId,PdFeesName:"",PdRate:""},success:function(){$table.bootstrapTable("refresh");swal({title:"Add Fees to Product",text:"CASA Fees Addition/Deletion Completed successfully!",type:"success"}).then(function(){});$("#ddlProductname").val(null).trigger("change")},error:function(){swal({title:"Fee Mapping",text:"CASA Fees Addition/Deletion Completed successfully!",type:"error"}).then(function(){})}}),console.log(itemData),console.log(productFeeListIdExtra[counter]));counter++});counter=0;$.each(newselectionData,function(index,itemData){console.log(itemData);productFeeListNew.includes(itemData.pdFeesId)&&productFeeListExtra.includes(itemData.pdFeesId)?(console.log("Do Nothing"),console.log(itemData)):productFeeListNew.includes(itemData.pdFeesId)&&!productFeeListExtra.includes(itemData.pdFeesId)?(console.log("Insert Into Database"),$.ajax({url:"../Account/AddProductFeesList",type:"POST",data:{Id:1,PdFeesId:newselectionData[counter].pdFeesId,casaAccountId:casaAccountId,productId:productId,PdFeesName:newselectionData[counter].pdFeesName,PdRate:newselectionData[counter].pdRate},success:function(){$table.bootstrapTable("refresh");swal({title:"Add Fees to Product",text:"CASA Fees Addition/Deletion Completed successfully!",type:"success"}).then(function(){})},error:function(){swal({title:"Fee Mapping",text:"CASA Fees Addition/Deletion encountered an error",type:"error"}).then(function(){})}}),console.log(itemData)):!productFeeListNew.includes(itemData.pdFeesId)&&productFeeListExtra.includes(itemData.pdFeesId)&&(console.log("Delete from Database"),console.log(itemData));counter++});$("#accountFeeUpdateModal").modal("hide")},updateProduct:function(){var $table,productDetails,productDetailsArray;if($table=$("#productListTable"),productDetails=JSON.stringify($table.bootstrapTable("getSelections")),!productDetails||productDetails.length==2){$.notify({icon:"now-ui-icons travel_info",message:"Please Select A Product"},{type:"danger",placement:{from:"top",align:"right"}});return}if(approvalstatusBoolean=="Pending"){$.notify({icon:"now-ui-icons travel_info",message:"Pending Approval"},{type:"danger",placement:{from:"top",align:"right"}});return}productDetailsArray=$table.bootstrapTable("getSelections");console.log(productDetailsArray[0].id);console.log("Insert Into Database");$.ajax({url:"../Account/UpdateAccountProductConversionApprovalStatus",type:"POST",data:{id:casaAccountId,productid:productDetailsArray[0].id},success:function(){$table.bootstrapTable("refresh");swal({title:"Add Fees to Product",text:"Account Product Conversion Update Completed successfully!",type:"success"}).then(function(){})},error:function(){swal({title:"Fee Mapping",text:"Account Product Conversion Update encountered an error",type:"error"}).then(function(){})}});$("#formProductUpdate #updateBtn").attr("disabled","disabled")}};